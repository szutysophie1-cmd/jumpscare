<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Visual test</title>
<style>
  html,body{height:100%;margin:0;background:#000;color:#fff;font-family:system-ui,Segoe UI,Roboto,Arial}
  .bait{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:12px;padding:20px;text-align:center}
  .bait img{max-width:90%;height:auto;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.6)}
  #scare {
    position:fixed;inset:0;background:#000;display:none;align-items:center;justify-content:center;z-index:9999;
  }
  #scare img{max-width:100%;max-height:100%}
  .controls{position:fixed;right:12px;top:12px;z-index:10001}
  .btn{background:#fff;color:#000;padding:8px 10px;border-radius:6px;border:none;cursor:pointer}
</style>
</head>
<body>
  <div class="bait" id="bait">
    <h1>Can you spot the faint detail?</h1>
    <p>Focus on the center for 7 seconds.</p>
    <!-- This is the bait image — keep it innocent -->
    <img src="scare.jpg" alt="Focus image" width="560" />
    <small>Tip: Do not use this on people with heart conditions, epilepsy, or severe anxiety.</small>
  </div>

  <div id="scare" role="dialog" aria-hidden="true">
    <!-- The scary image (replace filename if needed) -->
    <img src="scare.jpg" id="scareImg" alt="!!!" />
    <audio id="screamAudio" preload="auto" src="scream.mp3"></audio>
    <div style="position:fixed;left:12px;top:12px;">
      <button class="btn" id="closeBtn">Close</button>
    </div>
  </div>

<script>
(function(){
  const DELAY = 7000; // milliseconds before jumpscare
  const scareEl = document.getElementById('scare');
  const audio = document.getElementById('screamAudio');
  const bait = document.getElementById('bait');
  const closeBtn = document.getElementById('closeBtn');

  // Try to autoplay; if browser blocks playback with sound, listen for first user interaction
  let autoplayAttempted = false;
  function attemptPlay() {
    if (autoplayAttempted) return;
    autoplayAttempted = true;
    audio.volume = 1.0;
    const p = audio.play();
    if (p !== undefined) {
      p.catch(()=>{ /* blocked by browser — will play later on user interaction */ });
    }
  }

  // show the scare (image already set to scare.jpg)
  function showScare(){
    // display full-screen
    scareEl.style.display = 'flex';
    scareEl.setAttribute('aria-hidden','false');

    // try to play; if blocked, play on the next user interaction
    const playPromise = audio.play();
    if (playPromise !== undefined) {
      playPromise.catch(()=>{
        const onInteract = ()=>{
          audio.play().catch(()=>{});
          window.removeEventListener('click', onInteract);
          window.removeEventListener('keydown', onInteract);
        };
        window.addEventListener('click', onInteract);
        window.addEventListener('keydown', onInteract);
      });
    }
  }

  // schedule the scare after the delay
  const timer = setTimeout(showScare, DELAY);

  // if user clicks the page before the delay, try to unlock audio so it will play
  window.addEventListener('click', attemptPlay, {once:true});
  window.addEventListener('keydown', attemptPlay, {once:true});

  // close button
  closeBtn.addEventListener('click', ()=>{
    audio.pause();
    audio.currentTime = 0;
    scareEl.style.display = 'none';
    clearTimeout(timer);
  });

  // Safety: also allow Escape to close
  window.addEventListener('keydown', (e)=>{
    if (e.key === 'Escape') {
      audio.pause();
      audio.currentTime = 0;
      scareEl.style.display = 'none';
      clearTimeout(timer);
    }
  });
})();
</script>
</body>
</html>
